{{- if .Values.secrets.enabled }}
{{- if .Values.secrets.SECRET_KEY }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "ai-agent-connector.secretName" . }}
  labels:
    {{- include "ai-agent-connector.labels" . | nindent 4 }}
type: Opaque
data:
  {{- if .Values.secrets.SECRET_KEY }}
  SECRET_KEY: {{ .Values.secrets.SECRET_KEY | b64enc }}
  {{- end }}
  {{- if .Values.secrets.ENCRYPTION_KEY }}
  ENCRYPTION_KEY: {{ .Values.secrets.ENCRYPTION_KEY | b64enc }}
  {{- end }}
  {{- if .Values.secrets.OPENAI_API_KEY }}
  OPENAI_API_KEY: {{ .Values.secrets.OPENAI_API_KEY | b64enc }}
  {{- end }}
  {{- if .Values.secrets.ANTHROPIC_API_KEY }}
  ANTHROPIC_API_KEY: {{ .Values.secrets.ANTHROPIC_API_KEY | b64enc }}
  {{- end }}
  {{- if .Values.secrets.DB_PASSWORD }}
  DB_PASSWORD: {{ .Values.secrets.DB_PASSWORD | b64enc }}
  {{- end }}
  {{- range $key, $value := .Values.secrets }}
  {{- if and (ne $key "enabled") (ne $key "SECRET_KEY") (ne $key "ENCRYPTION_KEY") (ne $key "OPENAI_API_KEY") (ne $key "ANTHROPIC_API_KEY") (ne $key "DB_PASSWORD") }}
  {{ $key }}: {{ $value | b64enc }}
  {{- end }}
  {{- end }}
{{- else }}
# Secret should be created externally or via external-secrets operator
# This is a placeholder to show the expected secret structure
{{- end }}
{{- end }}
