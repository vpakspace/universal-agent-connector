openapi: 3.0.3
info:
  title: Universal Agent Connector API
  description: |
    AI Agent Infrastructure with Semantic Validation (OntoGuard).

    ## Features
    - **Agent Registry** - Register and manage AI agents
    - **OntoGuard Integration** - OWL ontology-based semantic validation
    - **Database Connectors** - PostgreSQL, MySQL, SQLite support
    - **Rate Limiting** - Per-agent request throttling
    - **Validation Caching** - LRU cache with TTL
    - **Schema Drift Detection** - DB schema change monitoring

    ## Authentication
    Use `X-API-Key` header with the API key returned from agent registration.

    ## OntoGuard Validation
    Use `X-User-Role` header to specify user role for semantic validation.
  version: 1.0.0
  contact:
    name: API Support
    url: https://github.com/vpakspace/universal-agent-connector
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:5000
    description: Development server

tags:
  - name: Authentication
    description: JWT token management and authentication
  - name: Agents
    description: Agent registration and management
  - name: Queries
    description: SQL and Natural Language query execution
  - name: OntoGuard
    description: Semantic validation using OWL ontologies
  - name: Schema
    description: Schema drift detection
  - name: Cache
    description: Validation cache management
  - name: Rate Limits
    description: Rate limiting configuration
  - name: Permissions
    description: Resource permissions management
  - name: Audit
    description: Audit trail and activity logging
  - name: Alerts
    description: Alerting integration (Slack, PagerDuty, webhooks)

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: Agent API Key for authentication
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT access token
    UserRoleHeader:
      type: apiKey
      in: header
      name: X-User-Role
      description: User role for OntoGuard validation

  schemas:
    AgentInfo:
      type: object
      properties:
        name:
          type: string
          example: "Dr. Smith"
        role:
          type: string
          example: "Doctor"
        department:
          type: string
          example: "Cardiology"

    DatabaseConfig:
      type: object
      required:
        - type
      properties:
        type:
          type: string
          enum: [postgresql, mysql, sqlite]
          example: "postgresql"
        host:
          type: string
          example: "localhost"
        port:
          type: integer
          example: 5433
        database:
          type: string
          example: "hospital_db"
        user:
          type: string
          example: "uac_user"
        password:
          type: string
          example: "uac_password"

    RateLimits:
      type: object
      properties:
        queries_per_minute:
          type: integer
          example: 60
        queries_per_hour:
          type: integer
          example: 1000
        queries_per_day:
          type: integer
          example: 10000

    ValidationResult:
      type: object
      properties:
        allowed:
          type: boolean
        reason:
          type: string
        constraints:
          type: array
          items:
            type: string
        suggestions:
          type: array
          items:
            type: string

    Error:
      type: object
      properties:
        error:
          type: string
        message:
          type: string

paths:
  /api/agents/register:
    post:
      tags:
        - Agents
      summary: Register a new AI agent
      description: Register an agent with optional database connection and rate limits
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - agent_id
              properties:
                agent_id:
                  type: string
                  example: "doctor-1"
                agent_info:
                  $ref: '#/components/schemas/AgentInfo'
                agent_credentials:
                  type: object
                  properties:
                    api_key:
                      type: string
                    api_secret:
                      type: string
                database:
                  $ref: '#/components/schemas/DatabaseConfig'
                rate_limits:
                  $ref: '#/components/schemas/RateLimits'
      responses:
        '201':
          description: Agent registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  agent_id:
                    type: string
                  api_key:
                    type: string
                  rate_limits:
                    $ref: '#/components/schemas/RateLimits'
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/agents:
    get:
      tags:
        - Agents
      summary: List all registered agents
      responses:
        '200':
          description: List of agents
          content:
            application/json:
              schema:
                type: object
                properties:
                  agents:
                    type: array
                    items:
                      type: object
                  count:
                    type: integer

  /api/agents/{agent_id}:
    get:
      tags:
        - Agents
      summary: Get agent information
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Agent information
        '404':
          description: Agent not found

    delete:
      tags:
        - Agents
      summary: Revoke an agent
      description: Complete cleanup including permissions, credentials, and rate limits
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Agent revoked
        '404':
          description: Agent not found

  /api/agents/{agent_id}/query:
    post:
      tags:
        - Queries
      summary: Execute SQL query
      description: Execute SQL query with permission enforcement, rate limiting, and OntoGuard validation
      security:
        - ApiKeyAuth: []
        - UserRoleHeader: []
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - query
              properties:
                query:
                  type: string
                  example: "SELECT * FROM patients"
                params:
                  type: array
                  items: {}
                as_dict:
                  type: boolean
                  default: false
      responses:
        '200':
          description: Query results
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items: {}
                  row_count:
                    type: integer
                  columns:
                    type: array
                    items:
                      type: string
        '401':
          description: Unauthorized
        '403':
          description: Action denied by OntoGuard
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  message:
                    type: string
                  retry_after:
                    type: integer

  /api/agents/{agent_id}/query/natural:
    post:
      tags:
        - Queries
      summary: Execute natural language query
      description: Convert natural language to SQL and execute
      security:
        - ApiKeyAuth: []
        - UserRoleHeader: []
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - query
              properties:
                query:
                  type: string
                  example: "Show all patients"
                as_dict:
                  type: boolean
                  default: false
      responses:
        '200':
          description: Query results
        '429':
          description: Rate limit exceeded

  /api/ontoguard/status:
    get:
      tags:
        - OntoGuard
      summary: Get OntoGuard status
      responses:
        '200':
          description: OntoGuard status
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [active, pass_through, not_initialized]
                  ontologies_loaded:
                    type: integer

  /api/ontoguard/validate:
    post:
      tags:
        - OntoGuard
      summary: Validate action against ontology
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - action
                - entity_type
              properties:
                action:
                  type: string
                  enum: [create, read, update, delete]
                entity_type:
                  type: string
                  example: "PatientRecord"
                context:
                  type: object
                  properties:
                    role:
                      type: string
                      example: "Doctor"
                    domain:
                      type: string
                      example: "hospital"
      responses:
        '200':
          description: Validation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationResult'

  /api/ontoguard/allowed-actions:
    get:
      tags:
        - OntoGuard
      summary: Get allowed actions for role
      parameters:
        - name: role
          in: query
          required: true
          schema:
            type: string
        - name: entity_type
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: List of allowed actions

  /api/cache/stats:
    get:
      tags:
        - Cache
      summary: Get cache statistics
      responses:
        '200':
          description: Cache statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  cache:
                    type: object
                    properties:
                      hits:
                        type: integer
                      misses:
                        type: integer
                      hit_rate:
                        type: number
                      size:
                        type: integer

  /api/cache/invalidate:
    post:
      tags:
        - Cache
      summary: Invalidate cache entries
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                action:
                  type: string
                entity_type:
                  type: string
                role:
                  type: string
                domain:
                  type: string
      responses:
        '200':
          description: Entries invalidated

  /api/rate-limits:
    get:
      tags:
        - Rate Limits
      summary: List all rate limits
      responses:
        '200':
          description: All rate limit configurations

  /api/rate-limits/default:
    get:
      tags:
        - Rate Limits
      summary: Get default rate limits
      responses:
        '200':
          description: Default rate limits

  /api/rate-limits/{agent_id}:
    get:
      tags:
        - Rate Limits
      summary: Get agent rate limit
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Agent rate limit configuration and usage

    put:
      tags:
        - Rate Limits
      summary: Set agent rate limit
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RateLimits'
      responses:
        '200':
          description: Rate limit updated

    delete:
      tags:
        - Rate Limits
      summary: Remove agent rate limit
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Rate limit removed

  /api/rate-limits/{agent_id}/reset:
    post:
      tags:
        - Rate Limits
      summary: Reset rate limit counters
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Counters reset

  /api/schema/drift-check:
    get:
      tags:
        - Schema
      summary: List schema bindings
      parameters:
        - name: entity
          in: query
          schema:
            type: string
        - name: domain
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Schema bindings

    post:
      tags:
        - Schema
      summary: Check schema drift
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                schemas:
                  type: object
                  additionalProperties:
                    type: object
      responses:
        '200':
          description: Drift check results

  /api/schema/drift-check/live:
    post:
      tags:
        - Schema
      summary: Live schema drift check
      description: Auto-detect schema from live database connection
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - agent_id
              properties:
                agent_id:
                  type: string
                entities:
                  type: array
                  items:
                    type: string
      responses:
        '200':
          description: Live drift check results

  /api/agents/{agent_id}/permissions:
    get:
      tags:
        - Permissions
      summary: Get agent permissions
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Agent permissions

    post:
      tags:
        - Permissions
      summary: Add agent permission
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - permission
              properties:
                permission:
                  type: string
                  enum: [READ, WRITE, DELETE, ADMIN]
      responses:
        '200':
          description: Permission added

  /api/agents/{agent_id}/resources/{resource}/permissions:
    post:
      tags:
        - Permissions
      summary: Add resource permission
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
        - name: resource
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - permission
              properties:
                permission:
                  type: string
                  enum: [READ, WRITE, DELETE, ADMIN]
      responses:
        '200':
          description: Resource permission added

  /api/auth/token:
    post:
      tags:
        - Authentication
      summary: Get JWT tokens
      description: Generate JWT access and refresh tokens using API key authentication
      security:
        - ApiKeyAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                role:
                  type: string
                  description: Optional user role for RBAC
                  example: "Doctor"
      responses:
        '200':
          description: JWT tokens generated
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "ok"
                  agent_id:
                    type: string
                  access_token:
                    type: string
                    description: Short-lived access token (30 min default)
                  refresh_token:
                    type: string
                    description: Long-lived refresh token (7 days default)
                  token_type:
                    type: string
                    example: "Bearer"
                  expires_in:
                    type: integer
                    description: Access token lifetime in seconds
                    example: 1800
        '401':
          description: Invalid API key

  /api/auth/refresh:
    post:
      tags:
        - Authentication
      summary: Refresh access token
      description: Generate new access token using refresh token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refresh_token
              properties:
                refresh_token:
                  type: string
                  description: Valid refresh token
      responses:
        '200':
          description: New access token generated
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  access_token:
                    type: string
                  token_type:
                    type: string
                  expires_in:
                    type: integer
        '401':
          description: Invalid or expired refresh token

  /api/auth/verify:
    post:
      tags:
        - Authentication
      summary: Verify JWT token
      description: Verify token validity and return payload
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - token
              properties:
                token:
                  type: string
                  description: JWT token to verify
                type:
                  type: string
                  enum: [access, refresh]
                  default: access
                  description: Token type to verify
      responses:
        '200':
          description: Token verification result
          content:
            application/json:
              schema:
                type: object
                properties:
                  valid:
                    type: boolean
                  payload:
                    type: object
                    properties:
                      agent_id:
                        type: string
                      role:
                        type: string
                      token_type:
                        type: string
                      expires_at:
                        type: string
                      issued_at:
                        type: string
                  error:
                    type: string

  /api/auth/revoke:
    post:
      tags:
        - Authentication
      summary: Revoke JWT token
      description: Revoke a token to prevent further use
      security:
        - ApiKeyAuth: []
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - token
              properties:
                token:
                  type: string
                  description: JWT token to revoke
      responses:
        '200':
          description: Token revoked
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  revoked:
                    type: boolean
        '401':
          description: Authentication required

  /api/auth/config:
    get:
      tags:
        - Authentication
      summary: Get JWT configuration
      description: Get JWT configuration (excluding secrets)
      responses:
        '200':
          description: JWT configuration
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  config:
                    type: object
                    properties:
                      algorithm:
                        type: string
                        example: "HS256"
                      access_token_expire_minutes:
                        type: integer
                        example: 30
                      refresh_token_expire_days:
                        type: integer
                        example: 7
                      issuer:
                        type: string

  # Audit Trail Endpoints
  /api/audit/logs:
    get:
      tags:
        - Audit
      summary: Get audit logs
      description: Retrieve audit logs with filtering and pagination
      parameters:
        - name: agent_id
          in: query
          schema:
            type: string
          description: Filter by agent ID
        - name: action_type
          in: query
          schema:
            type: string
          description: Filter by action type (e.g., query_execution, agent_registered)
        - name: status
          in: query
          schema:
            type: string
            enum: [success, error, denied]
          description: Filter by status
        - name: start_date
          in: query
          schema:
            type: string
            format: date-time
          description: Start date (ISO format)
        - name: end_date
          in: query
          schema:
            type: string
            format: date-time
          description: End date (ISO format)
        - name: limit
          in: query
          schema:
            type: integer
            default: 100
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        '200':
          description: Audit logs
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  logs:
                    type: array
                    items:
                      $ref: '#/components/schemas/AuditLogEntry'
                  total:
                    type: integer
                  limit:
                    type: integer
                  offset:
                    type: integer
                  has_more:
                    type: boolean
                  backend:
                    type: string
                    enum: [memory, file, sqlite]

  /api/audit/logs/{log_id}:
    get:
      tags:
        - Audit
      summary: Get audit log by ID
      parameters:
        - name: log_id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Audit log entry
        '404':
          description: Log not found

  /api/audit/statistics:
    get:
      tags:
        - Audit
      summary: Get audit statistics
      parameters:
        - name: agent_id
          in: query
          schema:
            type: string
          description: Filter by agent ID
        - name: days
          in: query
          schema:
            type: integer
            default: 7
          description: Number of days to include
      responses:
        '200':
          description: Audit statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  total_actions:
                    type: integer
                  period_days:
                    type: integer
                  by_action_type:
                    type: object
                  by_status:
                    type: object
                  by_day:
                    type: object
                  recent_actions:
                    type: array

  /api/audit/export:
    post:
      tags:
        - Audit
      summary: Export audit logs
      description: Export logs to file (JSONL or JSON format)
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                output_path:
                  type: string
                  default: logs/audit_export.jsonl
                agent_id:
                  type: string
                start_date:
                  type: string
                  format: date-time
                end_date:
                  type: string
                  format: date-time
                format:
                  type: string
                  enum: [jsonl, json]
                  default: jsonl
      responses:
        '200':
          description: Export successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  message:
                    type: string
                  count:
                    type: integer
                  output_path:
                    type: string

  /api/audit/config:
    get:
      tags:
        - Audit
      summary: Get audit logger configuration
      responses:
        '200':
          description: Audit configuration
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  backend:
                    type: string
                    enum: [memory, file, sqlite]
                  max_logs:
                    type: integer
                  action_types:
                    type: array
                    items:
                      type: string
    post:
      tags:
        - Audit
      summary: Update audit logger configuration
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                backend:
                  type: string
                  enum: [memory, file, sqlite]
                log_dir:
                  type: string
                db_path:
                  type: string
                max_logs:
                  type: integer
                max_file_size_mb:
                  type: integer
                max_files:
                  type: integer
      responses:
        '200':
          description: Configuration updated

  # Alerting Endpoints
  /api/alerts/channels:
    get:
      tags:
        - Alerts
      summary: List configured alert channels
      responses:
        '200':
          description: Alert channels list
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  channels:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                        type:
                          type: string
                          enum: [slack, pagerduty, webhook]
                        enabled:
                          type: boolean

  /api/alerts/channels/slack:
    post:
      tags:
        - Alerts
      summary: Add Slack channel
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - webhook_url
              properties:
                webhook_url:
                  type: string
                  description: Slack webhook URL
                channel:
                  type: string
                  description: Optional channel name
                username:
                  type: string
                  default: "UAC Alerts"
                icon_emoji:
                  type: string
                  default: ":warning:"
                min_severity:
                  type: string
                  enum: [INFO, WARNING, ERROR, CRITICAL]
                  default: WARNING
      responses:
        '200':
          description: Slack channel added
        '400':
          description: Invalid configuration

  /api/alerts/channels/pagerduty:
    post:
      tags:
        - Alerts
      summary: Add PagerDuty channel
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - routing_key
              properties:
                routing_key:
                  type: string
                  description: PagerDuty Events API v2 routing key
                min_severity:
                  type: string
                  enum: [INFO, WARNING, ERROR, CRITICAL]
                  default: ERROR
      responses:
        '200':
          description: PagerDuty channel added
        '400':
          description: Invalid configuration

  /api/alerts/channels/webhook:
    post:
      tags:
        - Alerts
      summary: Add generic webhook channel
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - url
              properties:
                url:
                  type: string
                  description: Webhook URL
                headers:
                  type: object
                  additionalProperties:
                    type: string
                  description: Optional HTTP headers
                min_severity:
                  type: string
                  enum: [INFO, WARNING, ERROR, CRITICAL]
                  default: WARNING
      responses:
        '200':
          description: Webhook channel added
        '400':
          description: Invalid configuration

  /api/alerts/channels/{channel_name}:
    delete:
      tags:
        - Alerts
      summary: Remove alert channel
      parameters:
        - name: channel_name
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Channel removed
        '404':
          description: Channel not found

  /api/alerts/test:
    post:
      tags:
        - Alerts
      summary: Send test alert
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                channel:
                  type: string
                  description: Optional specific channel to test
      responses:
        '200':
          description: Test alert sent

  /api/alerts/send:
    post:
      tags:
        - Alerts
      summary: Send custom alert
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - alert_type
                - title
                - severity
              properties:
                alert_type:
                  type: string
                  enum: [QUERY_SLOW, ONTOGUARD_DENIED, SCHEMA_DRIFT_CRITICAL, RATE_LIMIT_EXCEEDED, AGENT_ERROR, CUSTOM]
                title:
                  type: string
                severity:
                  type: string
                  enum: [INFO, WARNING, ERROR, CRITICAL]
                message:
                  type: string
                details:
                  type: object
      responses:
        '200':
          description: Alert sent
        '400':
          description: Invalid alert data

  /api/alerts/history:
    get:
      tags:
        - Alerts
      summary: Get alert history
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 100
        - name: severity
          in: query
          schema:
            type: string
            enum: [INFO, WARNING, ERROR, CRITICAL]
        - name: alert_type
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Alert history
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  alerts:
                    type: array
                    items:
                      $ref: '#/components/schemas/AlertEntry'
                  total:
                    type: integer

  /api/alerts/statistics:
    get:
      tags:
        - Alerts
      summary: Get alert statistics
      parameters:
        - name: days
          in: query
          schema:
            type: integer
            default: 7
      responses:
        '200':
          description: Alert statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  total_alerts:
                    type: integer
                  by_severity:
                    type: object
                  by_type:
                    type: object
                  by_channel:
                    type: object

  /api/alerts/config:
    get:
      tags:
        - Alerts
      summary: Get alerting configuration
      responses:
        '200':
          description: Alerting configuration
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  deduplication_window_seconds:
                    type: integer
                  channels_count:
                    type: integer
                  default_min_severity:
                    type: string

components:
  schemas:
    AlertEntry:
      type: object
      properties:
        id:
          type: string
        timestamp:
          type: string
          format: date-time
        alert_type:
          type: string
        title:
          type: string
        severity:
          type: string
          enum: [INFO, WARNING, ERROR, CRITICAL]
        message:
          type: string
        details:
          type: object
        channels_notified:
          type: array
          items:
            type: string

    AuditLogEntry:
      type: object
      properties:
        id:
          type: integer
        timestamp:
          type: string
          format: date-time
        action_type:
          type: string
        agent_id:
          type: string
        user_id:
          type: string
        status:
          type: string
          enum: [success, error, denied]
        details:
          type: object
        error_message:
          type: string
